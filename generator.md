## Ssg basics and extras



```js //recursively generate list of files to sitemapRaw.txt
const path = require("path");
const fs   = require("fs");
let files  = [];
function readDir(dir) {
  let dirf=fs.readdirSync(dir);
  for (let dirs of [true,false]) //do directories first
    dirf.forEach(f => {
      if (!(f.startsWith('.') || f.indexOf('_files')==0)) {
      const fullpath = path.join(dir, f);
      if (dirs && fs.statSync(fullpath).isDirectory()) {
        return readDir(fullpath); //recurse
      } else if (!dirs) {
          if(f.endsWith('.md') || f.endsWith('.html') || f.endsWith('.htm') || f.endsWith('.pdf') || f.endsWith('.txt') || f.endsWith('.jpg') || f.endsWith('.jpeg') || f.endsWith('.png') || f.endsWith('.gif'))
              return files.push(fullpath);
      }}
    })
}
readDir("./");
files.forEach((f,i)=>files[i]=f.replace(/\\/g,'/')); //change to forward slashes
let s="";
files.forEach(f => s+=f+'\n')
fs.writeFile("sitemapRaw.txt",s,(err)=>{ if (err) console.log(err); })
console.log('ok - sitemapRaw.txt saved');
```
```output
ok - sitemapRaw.txt saved
```

```js //replace wikilinks [[abc]] with [[full/path/to/abc|abc]]
//can use this before deploying the site to save checking wikilinks when a page is loaded
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
files=['test.md']; //uncomment for a test
files.forEach(f => {
    status(f);console.log(f);
    let t=''+fs.readFileSync(f);
    let re = /\[\[(.*?)]]/g,m;
    while (m = re.exec(t)) {
      let s = m[1], s1 = '', s2 = '';
      if (s.indexOf('|') > 0) [s,s2]=s.split('|');
      if (s.indexOf('.') < 0) s += '.md';
      s=s.toLowerCase();
      for (i = 0; i < files.length; i++) { //include all matching links
        if (files[i].toLowerCase().endsWith(s)) {
          if (s1 != '') s1 += '&';
          if (s2 == '') s2 = files[i].substring(files[i].lastIndexOf('/') + 1);
          if (s2.includes('.')) s2 = s2.substring(0, s2.indexOf('.'))
          s1 += '[[' + files[i] + '|' + s2 + ']]';
        }
      }
      if (s1 != '') {
        t = t.substring(0, re.lastIndex - m[0].length) + s1 + t.substring(re.lastIndex);
        re.lastIndex += s1.length - m[0].length;
      } else { //italicize missing link
        t = t.substring(0, re.lastIndex - m[0].length) + m[0].replace(/\[\[(.*)]]/,'*[$1]*') + t.substring(re.lastIndex);
      }
    }
    fs.writeFileSync(f,t);
})
status('');console.log('ok');
```
```output
test.md
ok
```

```js  //generate network.html to produce site network graphs
//this uses sitemapRaw.txt (generated by prevous codeblock) & searches each markdown file for links
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
//get markdown file names
let a=[],mdf=[],mdftest=[];
files.forEach(f => {
  if(f.endsWith('.md')) {
      mdf.push(f);
      mdftest.push(f.substring(0,f.length-3).toLowerCase());
    }
});
//get nodes = markdown files, edges = links, & groups/colours = path depth
let g='', iig=0, ig=0;
function group(a){ //generate groups as path depth
    if (a.substring(0,a.indexOf('/'))=='') {g='/';ig=0;}
    else if (a.substring(0,a.indexOf('/',a.indexOf('/')+1))==''){
        if (g==a.substring(0,a.indexOf('/'))){ig=iig;}
        else {g=a.substring(0,a.indexOf('/'));ig=++iig;}
    } else {
        if (g==a.substring(0,a.indexOf('/',a.indexOf('/')+1))){ig=iig;}
        else {g=a.substring(0,a.indexOf('/',a.indexOf('/')+1));ig=++iig;}
    }
    return ig;
}
let edges='[', nodes='[', nedges=0, mults=0;
for (let i=0;i<mdf.length;i++) { //for each markdown file
  //append node
  let f=mdf[i];
  nodes+='{ id: '+i+', label: "'+f.substring(f.lastIndexOf('/')+1,f.indexOf('.md'))+'", group: '+group(f)+', title: "'+f+'"  },\n';
  let text=fs.readFileSync(f);
  let temp=[];
  function findLinks(test){
    test=test.trim().toLowerCase();
    if(test.startsWith('http')) return; //skip if http
    test=test.replace(/%20/g,' ')
    // test=test.substring(test.lastIndexOf('/')+1);
    let multiple=false;
    for (let j=0;j<mdf.length;j++) {
        if(mdftest[j]==test || mdftest[j].endsWith('/'+test)) { //look for files which match link
            edges+='{ from: '+i+', to: '+j+' },\n';nedges++;
            if (multiple) mults++;
            else multiple=true;
            // break; //break here for first match only
        }
    } 
  }
  let re=/\[\[([\w\s/.-]*?)(\.md)?(\|.*)?\]\]/g; //re to find wikilinks, .md not needed for test
  while ((temp=re.exec(text))!=null) { findLinks(temp[1]); }
  re=/\]\(<?([^)]*?)\.md/g; //re to find markdown links to .md only
  while ((temp=re.exec(text))!=null) { findLinks(temp[1]); }
}
nodes+=']';edges+=']';
let html=`
<head>
<link rel="stylesheet" href="./lib/zetti.css">
<style>.vis-tooltip { position: absolute;}
</style><!-- this enables showing title on hover -->
</head>
<body>
<div id="mynetwork" style="position:relative;width: 100%; height: 100%;"></div>
<span id='toptitle' ></span>
<span style="position:absolute;  top: 0; right: 0;">
  <button title="more" onclick="ndepth++;subsetNodes();draw();" class="btn">&nbsp;+&nbsp;</button>
  <button title="less" onclick="ndepth--;if(ndepth==0)ndepth=1;subsetNodes();draw();" class="btn">&nbsp;-&nbsp;</button>
  <button id='btnnet' title="network" onclick="parent.peek(false,'')" class="btn">&nbsp;‚ùÑ&nbsp;</button>
</span>
<script src="lib/vis-network.min.js"></script>
<script>
let param=''+window.location;
if (param.indexOf('?')<0) param='index.md';
else param=param.substring(param.indexOf('?')+6).replace(/%20/g,' ');
param=param.toLowerCase();
if(parent.ifid=='peek2') document.getElementById('btnnet').style.display='none';
let ndepth=1;
var allNodes=${nodes};
var edges=${edges};
function getNodes(nodes1) { // get nodes connected to the nodes in nodes1
    function unique(value, index, self) { return self.indexOf(value) === index; }
    let nodes2=[];
    for (let n of nodes1) {
      nodes2.push(n);
      for (let e of edges) {
        if (e.from == n) { nodes2.push(e.to); }
        else if (e.to == n) { nodes2.push(e.from); }
      }
    }
    return nodes2.filter(unique).sort(function(a, b) {return a-b;});
}
let nodeNumsOrig=[];
if (param!='' && param.endsWith('.md')) { //param is the file name
    for (let i=0;i<allNodes.length;i++){
        if (allNodes[i].title.toLowerCase()==param) { nodeNumsOrig.push(i); }
    }
}
if (!param.endsWith('.md') || getNodes(nodeNumsOrig).length<=1) { 
      param=param.substring(0,param.lastIndexOf('/'));
      for (let i=0;i<allNodes.length;i++){ //if not markdown or only 1 node, get other nodes in same folder
        if (allNodes[i].title.substring(0,allNodes[i].title.lastIndexOf('/')).toLowerCase()==param) { nodeNumsOrig.push(i); }
      }
      ndepth=1;
}
function subsetNodes() {
    let nodeNums=[...nodeNumsOrig];
    for (let i=1;i<=ndepth;i++) nodeNums=[...getNodes(nodeNums)];
    let nodes=[...allNodes];
    for (let i=0;i<nodes.length;i++){ //draw orig node(s) square
      if (nodeNumsOrig.indexOf(i)>=0) {nodes[i].shape="square";nodes[i].size=25;nodes[i].group=255;}
    }
    for (let i=nodes.length-1;i>=0;i--){ //remove nodes not in nodeNums
      if (nodeNums.indexOf(i)<0)nodes.splice(i,1);
    }
    return nodes;
}
function draw() {
  if (parent.usedark) document.body.style.backgroundColor = "#111";
  else document.body.style.backgroundColor = "#eee";
  // create a network
  var container = document.getElementById("mynetwork");
  let nodes1=new vis.DataSet(subsetNodes());
  let edges1=new vis.DataSet(edges);
  var data = {
    nodes: nodes1,
    edges: edges1,
  };
  var options = {
    nodes: {
      shape: "dot",
      size: 16,
      font: {color: color()},
    },
    edges: {
      arrows: "to",
    },
    interaction: {hover: true, hoverConnectedEdges:true, tooltipDelay: 100,},
    physics: {
      forceAtlas2Based: {
        gravitationalConstant: -26,
        centralGravity: 0.005,
        springLength: 230,
        springConstant: 0.18,
      },
      maxVelocity: 146,
      solver: "forceAtlas2Based",
      timestep: 0.35,
      stabilization: { iterations: 150 },
    },
  };
  var network = new vis.Network(container, data, options);
  network.on('click',function(properties){ 
    if(properties.nodes.length>0  && getNodes([properties.nodes[0]]).length>1){
      ndepth=1; //reset depth for quick response
      let temp=allNodes[properties.nodes[0]].label.replace(/%20/g,' ');
      let temp2=window.parent.hroot+'?file='+allNodes[properties.nodes[0]].title;
      document.getElementById('toptitle').innerHTML=\x60<a onclick='parent.location="\x24{temp2}"''>\x24{temp}</a>\x60
      parent.hfile=allNodes[properties.nodes[0]].title;parent.fname=parent.hfile;
      parent.loadfile(parent.hfile,parent.main,false);
      nodeNumsOrig=[properties.nodes[0]];subsetNodes();draw();
    } 
  }); //end network on click, \x60 is & \x24 is $
}
function color() {
  if (parent.usedark) return '#ffffff';
  else return '#000000';
}
window.addEventListener("load", () => { draw(); });
</script></body>` //in network.on statement above, \x60 is ` & \x24 is $
fs.writeFile("network.html",html,(err)=>{ if (err) console.log(err); })
console.log('ok - network.html saved: '+mdf.length+','+nedges+','+mults);
```
> Feb 10 15:13 ok - network.html saved: 1614,5111,106
> Jan 31 16:53 ok - network.html saved: 1614,5111,106
> Dec 05 22:17 ok - network.html saved: 1607,5067,107
> Dec 04 15:52 ok - network.html saved: 1607,4004,96
> Dec 02 14:34 ok - network.html saved: 1609,4001,96


```js //to produce sitemap.txt for SEO
//enter the site url below (example shown) and run this code
//note that this is just for SEO, sitemapRaw.txt is used for index.html
siteUrl='https://rmzetti.github.io/what/';
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
let s='';
files.forEach(f => {
  if(f.endsWith('.md')) s+=siteUrl+'index.html?file='+f+'\n';
  else if(f!='') s+=siteUrl+f+'\n';
});
fs.writeFile("sitemap.txt",s,(err)=>{ if (err) console.log(err); })
```

```js
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
files.forEach(f=>status(''+f))
status('');console.log('ok');
```
```output
ok
```

```js
//produce file with combined text of .md & .txt files for search etc
let t=new Date().getTime()
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
let s='';
files.forEach((f,i) => {
  if(f.endsWith('.md') || f.endsWith('.txt')) {
    let t=(''+fs.readFileSync(f)).split('\n');
    t.forEach((line,j) =>{s+=line=''+i+' '+(j+1)+': '+line+'\n';})
    // t=t.replace(/^/mg,''+i+' ');
    //s+=t.join('\n');
  }
});
fs.writeFile("sitesearch.txt",s,(err)=>{ if (err) console.log(err); })
console.log('done in '+(new Date().getTime()-t)/1000+' sec')
```
```output
done in 0.005 sec
```
```js
//find in files using sitesearch.txt
let search='elderhood'
let t=new Date().getTime()
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
let s=(''+fs.readFileSync('sitesearch.txt')).split('\n');
let a=[];let regex=new RegExp(search,'i'); //ignore case
for (let line of s) if(line.replace(regex,'').length!=line.length){ //if(line.includes(search)){
  line=''+files[parseInt(line.substring(0,line.indexOf(' ')))]+','+line.substring(line.indexOf(' ')+1);
  a.push(line)
}
console.log(a.length)
console.log(a.join('\n\n'))
console.log('done in '+(new Date().getTime()-t)/1000+' sec')
```
```html
<p id='result'>Text </p>
<script>
document.getElementById('result').innerHTML='start'
async function getFiles() {
  try {
      let files = await fetch('./sitemapRaw.txt');
      files=await files.text();
      document.getElementById('result').innerHTML=''+files.split('\n')[1];
  } catch (error) {
      document.getElementById('result').innerHTML='error '+error
  }
}
getFiles();
</script>
```

```js
// produce json data with combined text of .md & .txt files for search etc
// format is { "title":"filename","body","file content (no quotes and \\n for \n)"},{etc..}
// & insert data into /bm25/bundle.js
let t=new Date().getTime()
const fs   = require("fs");
let files=(''+fs.readFileSync('sitemapRaw.txt')).split('\n');
let s='[';let i=0;
files.forEach((f,i) => {
  if(f.endsWith('.md') || f.endsWith('.txt')) {
    s+='{"title":"'+f+'","body":"';
    let t=(''+fs.readFileSync(f)).split('\n');
    t.forEach((line,j) =>{
      line=line.replace(/[^A-Za-z0-9 ,.]+/g,' ');
      s+=''+j+':'+line+'<br>';
    })
    s+='"},';
  }
});
s+=']';
let bundle=''+fs.readFileSync('bm25/bundle.js')
bundle=bundle.replace(/start json data[\s\S]*end json data/,'start json data\n'+s+'\n//end json data')
fs.writeFile("bm25/bundle.js",bundle,(err)=>{ if (err) console.log(err); })
console.log('done in '+(new Date().getTime()-t)/1000+' sec')
```
```output
done in 0.017 sec
```
Replace ^(?!.*pad.*).+$ with empty string:
 (?!) is a ‚Äúnegative lookahead‚Äù which is zero-width by itself, but matches only when it won't find the content inside of it. So there we're looking for just anything inside a line ‚Äî .+, then looking if it doesn't contain pad prefixed with any other symbols ‚Äî (?!.*pad.*), and if this expression would be found, we can replace it with an empty string that would basically remove the line.

```js //original data in bm25 bundle
const fs   = require("fs");
let s=''+fs.readFileSync('/extras/bm25/test.json')
let bundle=''+fs.readFileSync('bm25/bundle.js')
bundle=bundle.replace(/start json data[\s\S]*end json data/,'start json data\n'+s+'\n//end json data')
fs.writeFile("bm25/bundle.js",bundle,(err)=>{ if (err) console.log(err); })
console.log('ok')
```
```output
ok
```

```html
<style>
    #myProgress {
      width: 100%;
      background-color: #ddd;
    }
    #myBar {
      width: 10%;
      height: 30px;
      background-color: #04AA6D;
      text-align: center;
      line-height: 30px;
      color: white;
    }
</style>
<div id="counter"></div>
  <div id="myProgress">
    <div id="myBar">0%</div>
  </div>
<script>
var elem = document.getElementById("myBar");
var width = 0;
var counter = document.querySelector('#counter');
var number = 0;
var countUp = function () {
	number++;
	//counter.textContent = number;
  elem.style.width = Math.round(number) + "%";
  elem.innerHTML = elem.style.width;
	if (number < 100) {window.requestAnimationFrame(countUp);}
};
window.requestAnimationFrame(countUp);
</script>
```
```html
<style>
    #myProgress {
      width: 100%;
      background-color: #ddd;
    }
    #myBar {
      width: 10%;
      height: 30px;
      background-color: #04AA6D;
      text-align: center;
      line-height: 30px;
      color: white;
    }
</style>
<div id="counter"></div>
  <div id="myProgress">
    <div id="myBar">0%</div>
  </div>
<script>
var elem = document.getElementById("myBar");
var width = 0;
var counter = document.querySelector('#counter');
number=0;
//for (number=0;number<=100;number++){
    let countUp = function () {
      elem.style.width = Math.round(number) + "%";
      elem.innerHTML = elem.style.width;
      number++
      if(number<100)window.requestAnimationFrame(countUp);
    };
//}
window.requestAnimationFrame(countUp);
</script>
```

```html
<body id='body'>
<p id='p1'></p>
<div id='d1'></div>
<script>
const response = await fetch("https://photos.google.com/share/AF1QipOqQg68u6icDpO1lHfWJblVUxLpBbuD6EURqQvm2av70YNvYM-lVJfmF9ZCBphxiA?key=OUNndTF4NmwtUnMwVi1TejlxNkpRRGYwam5yNGl3")
// document.getElementById('d1').innerHTML=''+response.text;
document.getElementById('p1').innerHTML='Hello';
</script>
</body>
```

```js:node //save google photos album image urls to file
const https=require('https')
const fs=require('fs')
const data = JSON.stringify({ offset: 0, })
const options = {
  hostname: 'photos.google.com', port: 443,
  path: '/share/AF1QipOqQg68u6icDpO1lHfWJblVUxLpBbuD6EURqQvm2av70YNvYM-lVJfmF9ZCBphxiA?key=OUNndTF4NmwtUnMwVi1TejlxNkpRRGYwam5yNGl3',
  method: 'GET',
};
console.log('hello')
const req = https.request(options, res => {
    // console.log(`statusCode: ${res.statusCode}`);
    let s='';
    res.on('data', d => {
      s=s+d.toString();
    });
    res.on('end',() => {
      let a='';
      while (s.indexOf('href="./share')>0){
        s=s.substring(s.indexOf('href="./share'));
        a=a+s.substring(0,s.indexOf('">')).replace('href="./share','<img src="https://photos.google.com/share')+'" width=600 /><br>\n';
        s=s.substring(300)
      }
      fs.writeFile("testphotos2.html",a,(err)=>{ if (err) console.log(err); })
    })
  });
  req.on('error', error => {
    console.log(''+error);
  });
  req.end();
  console.log('fin')
```
```output
hello
fin
```




```js
function test() {
  function check(hh){
      for (let i=0;i<hh.length;i++){
          for (let j=0;j<hh[i].length;j++){
              if (i===j) {hh[i][j]=0;}
              else {hh[i][j]+='x';}
      }}
      return hh;
  }
  let h0=[]; let pp=['1','2','3'];
  h0=[['1','2','3'],['1','2','3'],['1','2','3']];
  console.log('h0= ',h0);h0=check(h0);console.log('output (ok) = ',h0,'\n');
  
  let h1=[]; let rr=['1','2','3'];
  h1=[rr,rr,rr]; //the actual rr is now each of the three elements of h1
  // h1=[rr.slice(),rr.slice(),rr.slice()]; //copy of rr now the three elements of h1
  console.log('h1= ',h1);h1=check(h1);console.log('output= ',h1,'\n');  

  let h2=[]; let qq=['1','2','3'];
  for (let i=0;i<3;i++){h2.push(qq);} //the actual qq is now each of the three elements of h2
  // for (let i=0;i<3;i++){h2.push(qq.slice());} //copy of qq now the three elements of h2
  console.log('h2= ',h2);h2=check(h2);console.log('output= ',h2);
}
test()
```
```output
h0=  [ [ '1', '2', '3' ], [ '1', '2', '3' ], [ '1', '2', '3' ] ]
output (ok) =  [ [ 0, '2x', '3x' ], [ '1x', 0, '3x' ], [ '1x', '2x', 0 ] ] 

h1=  [ [ '1', '2', '3' ], [ '1', '2', '3' ], [ '1', '2', '3' ] ]
output=  [ [ '0xx', '0x', 0 ], [ '0xx', '0x', 0 ], [ '0xx', '0x', 0 ] ] 

h2=  [ [ '1', '2', '3' ], [ '1', '2', '3' ], [ '1', '2', '3' ] ]
output=  [ [ '0xx', '0x', 0 ], [ '0xx', '0x', 0 ], [ '0xx', '0x', 0 ] ]
```

```js
const a = [2, 1, 4, 3];
console.log('a=',a);
a.sort();
console.log('now, a= ',a)
//console.log('same as b= ',b);
```
```output
a= [ 2, 1, 4, 3 ]
now, a=  [ 1, 2, 3, 4 ]
```

```js
function onlyUnique(value, index, self) {
  return self.indexOf(value) === index;
}
var a = [{a:1,b:2},{a:2,b:2},{a:2,b:1},{a:2,b:3},{a:2,b:2},{a:1,b:2}];
var unique = a.filter(onlyUnique)//.sort(function(a, b) {return a-b;});
unique=>>[object Object],[object Object],[object Object],[object Object],[object Object],[object Object]
unique.indexOf(9)=>>-1
```

```js
t='this [[test1]] and [[test2/test]] and [[test3]]'
let re=/\[\[([^.\n]*?)]]/g,m;
while(m=re.exec(t)) {
  t=t.substring(0,re.lastIndex-m[0].length)+'[['+m[1]+'.md]]'+t.substring(re.lastIndex);
}
t=>>this [[test1.md]] and [[test2/test.md]] and [[test3.md]]
```
```js
text='this [[test1.md]] and [[test2/test.md]] and [[test3]]'
let re=/\[\[((\w|\s|\/)*?)(\.md)?\]\]/g; //re to find wikilinks
let temp=[],ans='',ans2='',ans3='';
while ((temp=re.exec(text))!=null) { //for each wikilink
    ans+=temp[0]+',';
    ans2+=temp[0].substring(2,temp[0].length-2).toLowerCase()+',';
    ans3+=temp[1]+',';
}
console.log(ans)
console.log(ans2)
console.log(ans3)
```
```output
[[test1.md]],[[test2/test.md]],[[test3]],
test1.md,test2/test.md,test3,
test1,test2/test,test3,
```

```js
test='asdfasdfasfsd.md'
test.substring(test.lastIndexOf('/')+1)=>>asdfasdfasfsd.md
test.substring(0,test.lastIndexOf('/'))=>> 
let i=-13,j=10
test.substring(i)=>>asdfasdfasfsd.md
test.substr(i)=>>fasdfasfsd.md
test.substring(i,j)=>>asdfasdfas
test.substr(i,j)=>>fasdfasfsd
```

```js

```js
let g='';let iig=0;let ig=0;
function group(a){
if (a.substring(0,a.indexOf('/'))=='') {g='/';ig=0;}
else if (a.substring(0,a.indexOf('/',a.indexOf('/')+1))==''){
    if (g==a.substring(0,a.indexOf('/'))){ig=iig;}
    else {g=a.substring(0,a.indexOf('/'));ig=++iig;}
}
else {
    if (g==a.substring(0,a.indexOf('/',a.indexOf('/')+1))){ig=iig;}
    else {g=a.substring(0,a.indexOf('/',a.indexOf('/')+1));ig=++iig;}
}
return ig;
}
group('asdfasf/asdf/sdafs')=>>1
group('asdfasf/asdf/sdds')=>>1
group('asdfasf/asdg/sdds')=>>2
group('asdfasg/asdf/sdds')=>>3
group('asdfasf/assdds')=>>4
group('asdfasf asdf sdds')=>>0
```

```html
<style>
.navi {
  position: relative;
}
#infoi {
  position: absolute;
  top: 0;
  right: 0;
  height: 20px;
  padding: 10px 10px;
}
</style>
<!-- <div class="wrapper"> -->
  <div class="navi">
    <h1>Testing</h1>
This is a test

  </div>
  <div id="infoi">
 <button>Testing</button>
  </div>
<!-- </div> -->
```
```js
let left={},right={};
function test(x){
  if (x==left) return 'left';
  else if (x==right) return 'right';
  else return 'none';
}
test(left)=>>left
```
```js
let a=`[abc#def](https://whatamigoingtodonow.net/what/index.html?file=https://whatamigoingtodonow.net/what/what/KeepNotes.md)adfadfadf
adfdfasdf asdf asdf asdf sadf asdf ef](https://whatamigoingtodonow.net/what/index.html?file=https://whatamigoingtodonow.net/what/what/KeepNotes.md)adfadfadf
adfdfas`
let b=a.replace(/(http.*?)index.html\?file=\1/g,'$1index.html?file=');
console.log(b)
```

```js //yaml
yaml='title: This is a title\nmdflavor : original\ntest:content' 
yaml = yaml.split('\n').map(x=>x.split(':').map(y=>y.trim())).reduce((a,b)=>{a[b[0]]=b[1];return a;},{});
yaml.title=>>This is a title
```

```js
t=`
---
title: This is a title
mdflavor : original
test:content
---
### and so on
here we go
`
console.log(t.replace(/^\s*?---\s(.*?)\s---.*/s,'$1'))
```
```js
let s='abc,def,ghi';let x;
let a={type2:'ghi',content:'xxx'};
if (s.includes(a.type1 || a.type2))x=(a.type1 || a.type2)
else x='github';
x=>>ghi
```

## Repos
```js
 a=
 //#p2
 { 'budd':5.17, 
 'buddwindows':0.132, 
 'casual':40.2, 
 'docs':0.827, 
 'docu':2.31, 
 'eleventy-garden':3.09, 
 'foam-digital-garden':2.16, 
 'foam1':42.2, 
 'Gexplore':0.038, 
 'green':5.91, 
 'hover-exec':254, 
 'hover-exec-samples':34.9, 
 'Javascripter':0.708, 
 'journal':0.012, 
 'mindstone':7.89, 
 'Notes':63.5, 
 'osmos':0.774, 
 'quartz':1.76, 
 'rmz':4.29, 
 'rmzetti.github.io':49.3,
 'rmzetti.hover-exec.old':35.1,
 'Tech':5.35, 
 'unotes':1.9, 
 'what':82, 
 'what2':11, 
 'whatAstro':0.863, 
 'whatFoam':6.07, 
 'whatObsidian':8.23, 
 'whattemp':40.5, 
 'zettel':28.3,
 }
//#p2
let t=0;
for (let i in a) t+=a[i];
t=>>738.484
```


```html //plot of repo storage usage above 5Dec2022
<!-- '''html //test using plotly -->
 <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
<div id="plot" style="width:70%;height:500px"></div>
<script>
let lm='lines+markers'
let a=`include #p2`
let x=Object.keys(a);
let y1=Object.values(a);
plot1 = document.getElementById('plot');
Plotly.plot( plot1, [{ x: x, y: y1, type:'bar'},],{title:'repo storage 5Dec2022 <a href="https://plotly.com/javascript/">(plotly docs)</a>'});
</script>
```

```js
let hroot='http://127.0.0.1:5500/';
let s=hroot+'test.md';
alert('1 ' + s +','+s.startsWith(hroot)+': '+s.substring(hroot.length));
s=s.substring(hroot.length);
alert('2 ' + s );
s = hroot + 'file=' + s;
alert('3 ' + s ); 
s=>>http://127.0.0.1:5500/file=test.md
```

```js
let hroot='http://127.0.0.1:5500/';
let ti={href:'http://127.0.0.1:5500/syntax.md'};
let s=ti.href;
if( s.startsWith(hroot)) s=s.substring(hroot.length);
s=>>syntax.md
ti.href = hroot + 'file=' + s;
ti.href=>>http://127.0.0.1:5500/file=syntax.md
```



